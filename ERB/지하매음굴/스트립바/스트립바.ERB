@스트립바
PRINTFORML 스트립 바에 왔다...
$스트립바루프
DRAWLINE
CALL 스트립바정경묘사
DRAWLINE
CALL 스트립바커맨드
$스트립바입력
INPUT
IF RESULT == 999
    RETURN 1
ELSEIF RESULT == 100
    CALL 스트립바주문
ELSEIF RESULT == 101
    CALL 촉수궁경마장
ELSE
    GOTO 스트립바입력
ENDIF
GOTO 스트립바루프

@스트립바정경묘사


@스트립바커맨드
PRINTFORML [100] 주문
PRINTFORML [101] 촉수궁 경마장
PRINTFORML [999] 돌아간다


@스트립바주문
PRINTFORML "안녕~하세요~"
$스트립바주문루프
DRAWLINE
PRINTFORML "어떤 걸 원하시나요~?"
DRAWLINE


PRINTFORML [999]돌아간다
INPUT
IF RESULT == 999
    RETURN 1
ELSE

ENDIF

@촉수궁경마장
#DIM DYNAMIC 베팅대상
PRINTFORML 바 한 켠에 놓은 TV에서 출발선에 선 소녀들이 보인다...
PRINTFORML 한편 누가 우승할 지 베팅이 시작되고 있는 모양이다
PRINTFORML 참여하시겠습니까?
PRINTFORML [1] 참여한다
PRINTFORML [2] 관전만
PRINTFORML [9] 돌아간다
$경마장초기입력
INPUT
IF RESULT == 9
    RETURN 1
ELSEIF RESULT == 1
    PRINTFORML 누구에게 돈을 걸까?
    CALL 창녀목록(0)
    PRINTFORML [999]돌아간다
    $베팅대상선정
    INPUT
    IF RESULT == 999
        RESTART
    ELSE
        IF (TALENT:RESULT:창녀 == 1||TALENT:RESULT:렌탈창녀 == 1)&&(CFLAG:RESULT:창관일 == 5)&&CFLAG:RESULT:오늘몸팜 == 0
            베팅대상 = RESULT
            CALL 촉수궁(베팅대상)
        ELSE
            GOTO 베팅대상선정
        ENDIF
    ENDIF
ELSEIF RESULT == 2
    CALL 촉수궁(0)
ELSE
    GOTO 경마장초기입력
ENDIF

@촉수궁(ARG)
#DIM DYNAMIC 참여자, 10
#DIM DYNAMIC 참여자임시배열, 300
#DIM DYNAMIC 참여자임시포인터
#DIM DYNAMIC 참여자포인터



VARSET 촉수궁맵
;PHASE 1 참여자 선정
참여자포인터 = 1
참여자:0 = ARG
FOR LOCAL, 1, CHARANUM
    IF (TALENT:LOCAL:창녀 == 1||TALENT:LOCAL:렌탈창녀 == 1)&&(CFLAG:LOCAL:창관일 == 5)&&CFLAG:LOCAL:오늘몸팜 == 0
        IF LOCAL != ARG
            참여자임시배열:참여자임시포인터 = LOCAL
            참여자임시포인터++
        ENDIF
    ENDIF
NEXT
IF 참여자:0 == 0
    FOR LOCAL, 0, 9
        FOR LOCAL:1,0,참여자임시포인터-1
            IF RAND:3 == 0
                FOR LOCAL:2,0,9
                    IF 참여자임시배열:(LOCAL:1) == 참여자:(LOCAL:2)
                        LOCAL:3 = 1
                        BREAK
                    ENDIF
                NEXT
                IF LOCAL:3 == 0
                    참여자:참여자포인터 = 참여자임시배열:(LOCAL:1)
                    참여자포인터 ++
                ELSE
                    LOCAL:3 = 0
                ENDIF
            ENDIF
            IF 참여자포인터 >= 9
                BREAK
            ENDIF
        NEXT
        IF 참여자포인터 >= 9
            BREAK
        ENDIF
    NEXT
ELSE
    FOR LOCAL, 1, 9
        FOR LOCAL:1,0,참여자임시포인터-1
            IF RAND:3 == 0
                FOR LOCAL:2,0,9
                    IF 참여자임시배열:(LOCAL:1) == 참여자:(LOCAL:2)
                        LOCAL:3 = 1
                        BREAK
                    ENDIF
                NEXT
                IF LOCAL:3 == 0
                    참여자:참여자포인터 = 참여자임시배열:(LOCAL:1)
                    참여자포인터 ++
                ELSE
                    LOCAL:3 = 0
                ENDIF
            ENDIF
            IF 참여자포인터 >= 9
                BREAK
            ENDIF
        NEXT
        IF 참여자포인터 >= 9
            BREAK
        ENDIF
    NEXT
ENDIF

PRINTL
PRINTFORML ★★★★★★★★참가자 선정 완료★★★★★★★★
SIF 참여자:0 != 0
    PRINTFORML 1번 참여자 : %CALLNAME:(참여자:0)%
SIF 참여자:1 != 0
    PRINTFORML 2번 참여자 : %CALLNAME:(참여자:1)%
SIF 참여자:2 != 0
    PRINTFORML 3번 참여자 : %CALLNAME:(참여자:2)%
SIF 참여자:3 != 0
    PRINTFORML 4번 참여자 : %CALLNAME:(참여자:3)%
SIF 참여자:4 != 0
    PRINTFORML 5번 참여자 : %CALLNAME:(참여자:4)%
SIF 참여자:5 != 0
    PRINTFORML 6번 참여자 : %CALLNAME:(참여자:5)%
SIF 참여자:6 != 0
    PRINTFORML 7번 참여자 : %CALLNAME:(참여자:6)%
SIF 참여자:7 != 0
    PRINTFORML 8번 참여자 : %CALLNAME:(참여자:7)%
SIF 참여자:8 != 0
    PRINTFORML 9번 참여자 : %CALLNAME:(참여자:8)%
SIF 참여자:9 != 0
    PRINTFORML 10번 참여자 : %CALLNAME:(참여자:9)%

;PHASE 2 맵 선정
REPEAT 40
    ;가로로 쭉~ 외벽을 쌓는다
    촉수궁맵:COUNT:0 '= "■"
    촉수궁맵:COUNT:19 '= "■"
REND
REPEAT 18
    ;이번엔 세로 벽을 세움
    촉수궁맵:0:(COUNT+1) '= "■"
    촉수궁맵:39:(COUNT+1) '= "■"
REND
REPEAT 9
    ;가로
    ;시작 방
    촉수궁맵:(COUNT+1):12 '= "■"
    ;끝방
    촉수궁맵:(39-COUNT):7 '= "■"
REND
REPEAT 6
    ;세로
    ;시작 방
    촉수궁맵:9:(12+COUNT) '= "■"
    ;끝방
    촉수궁맵:30:(7-COUNT) '= "■"
REND
SIF 참여자:0 != 0
    P0:0 = 참여자:0
SIF 참여자:1 != 0
    P1:0 = 참여자:1
SIF 참여자:2 != 0
    P2:0 = 참여자:2
SIF 참여자:3 != 0
    P3:0 = 참여자:3
SIF 참여자:4 != 0
    P4:0 = 참여자:4
SIF 참여자:5 != 0
    P5:0 = 참여자:5
SIF 참여자:6 != 0
    P6:0 = 참여자:6
SIF 참여자:7 != 0
    P7:0 = 참여자:7
SIF 참여자:8 != 0
    P8:0 = 참여자:8
SIF 참여자:9 != 0
    P9:0 = 참여자:9

;SELECTCASE RAND:3
    ;CASE 0
        ;하나의 함정과 두개의 살 길
        REPEAT 28
            촉수궁맵:(10+COUNT):17 '= "■"
        REND
        REPEAT 8
            촉수궁맵:37:(16-COUNT) '= "■"
        REND
        REPEAT 7
            촉수궁맵:35:(15-COUNT) '= "■"
        REND
        REPEAT 24
            촉수궁맵:(34-COUNT):15 '= "■"
        REND
        REPEAT 3
            촉수궁맵:11:(14-COUNT) '= "■"
        REND
        촉수궁맵:30:8 '= "■"
        촉수궁맵:31:8 '= "■"
        촉수궁맵:32:8 '= "■"
        촉수궁맵:33:8 '= "■"
        촉수궁맵:33:9 '= "■"
        촉수궁맵:33:11 '= "■"
        촉수궁맵:33:12 '= "■"
        REPEAT 29
            촉수궁맵:(30-COUNT):2 '= "■"
        REND
        촉수궁맵:2:3 '= "■"
        촉수궁맵:2:4 '= "■"
        촉수궁맵:2:5 '= "■"
        촉수궁맵:2:6 '= "■"
        촉수궁맵:2:7 '= "■"
        촉수궁맵:2:8 '= "■"
        촉수궁맵:2:9 '= "■"
        촉수궁맵:2:10 '= "■"
        REPEAT 29
            촉수궁맵:(3+COUNT):10 '= "■"
        REND
        REPEAT 21
            촉수궁맵:(33-COUNT):12 '= "■"
            촉수궁맵:(33-COUNT):13 '= "■"
        REND
        REPEAT 25
            촉수궁맵:(28-COUNT):8 '= "■"
            촉수궁맵:(28-COUNT):7 '= "■"
            촉수궁맵:(28-COUNT):6 '= "■"
            촉수궁맵:(28-COUNT):5 '= "■"
            촉수궁맵:(28-COUNT):4 '= "■"
        REND
        P0:1 = 2
        P1:1 = 2
        P2:1 = 2
        P3:1= 2
        P4:1= 2
        P5:1= 3
        P6:1= 3
        P7:1= 3
        P8:1= 3
        P9:1= 3
        P0:2 = 18
        P1:2 = 18
        P2:2 = 18
        P3:2= 18
        P4:2= 18
        P5:2= 18
        P6:2= 18
        P7:2= 18
        P8:2= 18
        P9:2= 18
        촉수궁엔드:0 = 31
        촉수궁엔드:1 = 1
    ;CASE 1

    ;CASE 2

;ENDSELECT
;------------------
DRAWLINE
PRINTL 맵
DRAWLINE
FOR LOCAL,0,20
    FOR LOCAL:1, 0, 40
        IF ANYONE_IN_THERE(LOCAL:1,LOCAL) > 0
            CALL WHO_IN_THERE(LOCAL:1,LOCAL)
        ELSEIF 촉수궁엔드:0 == LOCAL:1&&촉수궁엔드:1 == LOCAL
            PRINTFORM 完
        ELSEIF 촉수궁맵:(LOCAL:1):LOCAL == ""
            PRINTFORM  .
        ELSE
            PRINTFORM %촉수궁맵:(LOCAL:1):LOCAL%
        ENDIF
    NEXT
    PRINTL
NEXT
;PHASE 3 런

;PHASE 4 결과 반환

@ANYONE_IN_THERE(ARG,ARG:1)
#FUNCTION
#DIM DYNAMIC 겹치는인원
#DIM DYNAMIC 누구야, 9
IF ARG == P0:1&&P0:0 != 0
    IF ARG:1 == P0:2
        겹치는인원++
        누구야:0 = 1
    ENDIF
ENDIF
IF ARG == P1:1&&P1:0 != 0
    IF ARG:1 == P1:2
        겹치는인원++
        누구야:1 = 1
    ENDIF
ENDIF
IF ARG == P2:1&&P2:0 != 0
    IF ARG:1 == P2:2
        겹치는인원++
        누구야:2 = 1
    ENDIF
ENDIF
IF ARG == P3:1&&P3:0 != 0
    IF ARG:1 == P3:2
        겹치는인원++
        누구야:3 = 1
    ENDIF
ENDIF
IF ARG == P4:1&&P4:0 != 0
    IF ARG:1 == P4:2
        겹치는인원++
        누구야:4 = 1
    ENDIF
ENDIF
IF ARG == P5:1&&P5:0 != 0
    IF ARG:1 == P5:2
        겹치는인원++
        누구야:5 = 1
    ENDIF
ENDIF
IF ARG == P6:1&&P6:0 != 0
    IF ARG:1 == P6:2
        겹치는인원++
        누구야:6 = 1
    ENDIF
ENDIF
IF ARG == P7:1&&P7:0 != 0
    IF ARG:1 == P7:2
        겹치는인원++
        누구야:7 = 1
    ENDIF
ENDIF
IF ARG == P8:1&&P8:0 != 0
    IF ARG:1 == P8:2
        겹치는인원++
        누구야:8 = 1
    ENDIF
ENDIF
IF ARG == P9:1&&P9:0 != 0
    IF ARG:1 == P9:2
        겹치는인원++
        누구야:9 = 1
    ENDIF
ENDIF
RETURNF 겹치는인원

@WHO_IN_THERE(ARG,ARG:1)
#DIM DYNAMIC 겹치는인원
#DIM DYNAMIC 누구야
IF ARG == P0:1&&P0:0 != 0
    IF ARG:1 == P0:2
        겹치는인원++
        누구야 = 0
    ENDIF
ENDIF
IF ARG == P1:1&&P1:0 != 0
    IF ARG:1 == P1:2
        겹치는인원++
        누구야 = 1
    ENDIF
ENDIF
IF ARG == P2:1&&P2:0 != 0
    IF ARG:1 == P2:2
        겹치는인원++
        누구야 = 2
    ENDIF
ENDIF
IF ARG == P3:1&&P3:0 != 0
    IF ARG:1 == P3:2
        겹치는인원++
        누구야 = 3
    ENDIF
ENDIF
IF ARG == P4:1&&P4:0 != 0
    IF ARG:1 == P4:2
        겹치는인원++
        누구야 = 4
    ENDIF
ENDIF
IF ARG == P5:1&&P5:0 != 0
    IF ARG:1 == P5:2
        겹치는인원++
        누구야 = 5
    ENDIF
ENDIF
IF ARG == P6:1&&P6:0 != 0
    IF ARG:1 == P6:2
        겹치는인원++
        누구야 = 6
    ENDIF
ENDIF
IF ARG == P7:1&&P7:0 != 0
    IF ARG:1 == P7:2
        겹치는인원++
        누구야 = 7
    ENDIF
ENDIF
IF ARG == P8:1&&P8:0 != 0
    IF ARG:1 == P8:2
        겹치는인원++
        누구야 = 8
    ENDIF
ENDIF
IF ARG == P9:1&&P9:0 != 0
    IF ARG:1 == P9:2
        겹치는인원++
        누구야 = 9
    ENDIF
ENDIF
IF 겹치는인원 == 1
    IF 누구야 <= 9
        PRINTFORM  {누구야+1}
    ELSE
        PRINTFORM {누구야+1}
    ENDIF
ELSEIF 겹치는인원 > 1
    PRINTFORM  @
ENDIF


@뉴탄막전투(ARG,ARG:1)
;ARG - 내 번호
;ARG:1 - 상대방 번호
CALL 뉴탄막전투초기화(ARG,ARG:1)
CALL 뉴탄막루틴

@뉴탄막전투초기화(ARG,ARG:1)
MASTER = ARG
TARGET= ARG:1


T_내체력 = BASE:ARG:체력+MIN((10*CFLAG:ARG:인내),1000)
T_내최대체력 = T_내체력
T_내힘 = CFLAG:MASTER:힘
T_내지성= CFLAG:MASTER:지성
T_내인내= CFLAG:MASTER:인내
T_내속도= CFLAG:MASTER:속도
T_내운= CFLAG:MASTER:운
T_내물리내성= CFLAG:MASTER:물리내성
T_내화염내성= CFLAG:MASTER:화염내성
T_내빙결내성= CFLAG:MASTER:빙결내성
T_내전격내성= CFLAG:MASTER:전격내성
T_내질풍내성= CFLAG:MASTER:질풍내성
T_내마력내성= CFLAG:MASTER:마력내성
T_내수격내성= CFLAG:MASTER:수격내성
T_내정신내성= CFLAG:MASTER:정신내성
;---
T_적체력 = BASE:TARGET:체력+MIN(10*(CFLAG:(ARG:1):인내),1000)
T_적최대체력 = T_적체력
T_적힘 = CFLAG:TARGET:힘
T_적지성= CFLAG:TARGET:지성
T_적인내= CFLAG:TARGET:인내
T_적속도= CFLAG:TARGET:속도
T_적운= CFLAG:TARGET:운
T_적물리내성= CFLAG:TARGET:물리내성
T_적화염내성= CFLAG:TARGET:화염내성
T_적빙결내성= CFLAG:TARGET:빙결내성
T_적전격내성= CFLAG:TARGET:전격내성
T_적질풍내성= CFLAG:TARGET:질풍내성
T_적마력내성= CFLAG:TARGET:마력내성
T_적수격내성= CFLAG:TARGET:수격내성
T_적정신내성= CFLAG:TARGET:정신내성
CALL 공방세팅

;----
;기타변수 초기화 
;----


;----

@공방세팅
T_내공격력= (T_내힘*20)+ (T_내속도*5)+(T_내공격력보정)
T_내방어력= (T_내속도*5)+ (T_내인내*15)+(T_내운)+(T_내방어력보정)
SELECTCASE ABL:MASTER:전투능력
    CASE 0
        TIMES T_내공격력, 1.0
        TIMES T_내방어력, 1.0
    CASE 1
        TIMES T_내공격력, 1.3
        TIMES T_내방어력, 1.3
    CASE 2
        TIMES T_내공격력, 1.6
        TIMES T_내방어력, 1.6
    CASE 3
        TIMES T_내공격력, 1.9
        TIMES T_내방어력, 1.9
    CASE 4
        TIMES T_내공격력, 2.2
        TIMES T_내방어력, 2.2
    CASE 5
        TIMES T_내공격력, 2.5
        TIMES T_내방어력, 2.5
    CASE 6
        TIMES T_내공격력, 2.7
        TIMES T_내방어력, 2.7
    CASE 7
        TIMES T_내공격력, 2.9
        TIMES T_내방어력, 2.9
    CASEELSE
        TIMES T_내공격력, 3.0
        TIMES T_내방어력, 3.0
ENDSELECT
IF 상태이상체크(MASTER, "취약")
    TIMES T_내방어력, 0.5
ENDIF
T_적공격력= (T_적힘*20) + (T_적속도*5)+(T_적공격력보정)
T_적방어력= (T_적속도*5)+ (T_적인내*15)+(T_적운)+(T_적방어력보정)
IF 고로시 == 1
    TIMES 적공격력, 2.0
    TIMES 적방어력, 2.0
ENDIF
SELECTCASE ABL:TARGET:전투능력
    CASE 0
        TIMES T_적공격력, 1.0
        TIMES T_적방어력, 1.0
    CASE 1
        TIMES T_적공격력, 1.3
        TIMES T_적방어력, 1.3
    CASE 2
        TIMES T_적공격력, 1.6
        TIMES T_적방어력, 1.6
    CASE 3
        TIMES T_적공격력, 1.9
        TIMES T_적방어력, 1.9
    CASE 4
        TIMES T_적공격력, 2.2
        TIMES T_적방어력, 2.2
    CASE 5
        TIMES T_적공격력, 2.5
        TIMES T_적방어력, 2.5
    CASE 6
        TIMES T_적공격력, 2.7
        TIMES T_적방어력, 2.7
    CASE 7
        TIMES T_적공격력, 2.9
        TIMES T_적방어력, 2.9
    CASEELSE
        TIMES T_적공격력, 3.0
        TIMES T_적방어력, 3.0
ENDSELECT
IF 상태이상체크(TARGET, "취약") > 0
    TIMES T_적방어력, 0.5
ENDIF


@뉴탄막루틴
$뉴탄막루틴시작

;---------
CALL 상태이상감소처리(MASTER)
CALL 버프감소처리(MASTER)
$내턴루틴
CALL 공방세팅
CALL 뉴탄막상태창
;-----------------
IF 상태이상체크(MASTER, "기절")
    PRINTL 기절중이라 행동할 수 없다!
    GOTO 적턴시작
ENDIF
IF 상태이상체크(MASTER, "혼란")&&RAND:2 == 0
    PRINTL 혼란에 빠져 행동할수 없다!
    GOTO 적턴시작
ENDIF
;-----------------
CALL 뉴탄막커맨드창
T_턴주인 = MASTER
T_턴반대 = TARGET
$내턴입력
INPUT
IF RESULT == 100
    ;공격
    CALL T_COM공격한다
ELSEIF RESULT == 101
    ;스킬사용
    IF 상태이상체크(MASTER, "침묵")
        PRINTW 침묵중이라 스킬을 시전할수 없다!
        GOTO 내턴입력
    ELSE
        CALL T_COM스킬사용
    ENDIF
ELSEIF RESULT == 102
    ;아이템사용
ELSEIF RESULT == 200
    ;회피
    CALL T_COM회피한다(MASTER)
ELSEIF RESULT == 201
    ;휴식
    ;일단은 아무처리 안함
ELSEIF RESULT == 999
    ;항복
    RETURN 1
ELSE
    GOTO 내턴입력
ENDIF
;--------
;적턴
;--------
$적턴시작
T_턴주인 = TARGET
T_턴반대 = MASTER
CALL 상태이상감소처리(TARGET)
CALL 버프감소처리(TARGET)
DRAWLINE
PRINTL
PRINTW 적턴 시작
PRINTL
CALL 공방세팅
CALL 뉴탄막상태창
;-------
IF 상태이상체크(TARGET, "기절")
    PRINTFORML %타겟은% 기절중이라 행동할 수 없다!
    GOTO 턴종료위치
ENDIF
IF 상태이상체크(TARGET, "혼란")&&RAND:2 == 0
    PRINTFORML %타겟은% 혼란에 빠져 행동할수 없다!
    GOTO 턴종료위치
ENDIF
;-------
;AI 활동영역
CALL 사고패턴결정(TARGET)
PRINTL
;-------
CALL T_턴엔드
;PRINTW

$턴종료위치
GOTO 뉴탄막루틴시작

@T_턴엔드
FOR LOCAL,1,1000
    TRYCALLFORM ONGOING_T_SKILL{LOCAL}(T_턴주인,"턴엔드")
    TRYCALLFORM ONGOING_T_SKILL{LOCAL}(T_턴반대,"턴엔드")
NEXT
T_TIME++

@뉴탄막커맨드창
ALIGNMENT CENTER
PRINTFORM [100] 공격 한다
PRINT    
PRINTFORM [101] 스킬 사용
PRINT    
PRINTFORM [102] 아이템 사용
PRINTL
PRINTFORM [200] 회피에 집중
PRINT    
PRINTFORM [201] 휴식
PRINTL
PRINTFORM [999] 항복
PRINTL
DRAWLINE
ALIGNMENT LEFT


@T_데미지(대상,데미지,속성)
#DIM 대상
#DIM 데미지
#DIMS 속성
PRINTFORM 피해량 : {데미지}
IF 대상 == MASTER
    IF 고로시 == 1
        TIMES 데미지 , 1.5
    ENDIF
    IF 속성 == "물리"
        IF T_내물리내성 > 0
            IF 데미지 >= T_내물리내성
                데미지 -= T_내물리내성
            ELSE
                데미지 = 0
            ENDIF
            PRINTFORM  -물리내성{T_내물리내성}
        ELSE
            데미지 += T_내물리내성
            SIF T_내물리내성 < 0
                PRINTFORM  +물리취약{T_내물리내성 * -1}
        ENDIF
    ELSEIF 속성 == "화염"
        IF T_내화염내성 > 0
            IF 데미지 >= T_내화염내성
                데미지 -= T_내화염내성
            ELSE
                데미지 = 0
            ENDIF
            PRINTFORM  -화염내성{T_내화염내성}
        ELSE
            데미지 += T_내화염내성
            SIF T_내화염내성 < 0
                PRINTFORM  +화염취약{T_내화염내성 * -1}
        ENDIF
    ELSEIF 속성 == "빙결"
        IF T_내빙결내성 > 0
            IF 데미지 >= T_내빙결내성
                데미지 -= T_내빙결내성
            ELSE
                데미지 = 0
            ENDIF
            PRINTFORM  -빙결내성{T_내빙결내성}
        ELSE
            데미지 += T_내빙결내성
            SIF T_내빙결내성 < 0
                PRINTFORM  +빙결취약{T_내빙결내성 * -1}
        ENDIF
    ELSEIF 속성 == "전격"
        IF T_내전격내성 > 0
            IF 데미지 >= T_내전격내성
                데미지 -= T_내전격내성
            ELSE
                데미지 = 0
            ENDIF
            PRINTFORM  -전격내성{T_내전격내성}
        ELSE
            데미지 += T_내전격내성
            SIF T_내전격내성 < 0
                PRINTFORM  +전격취약{T_내전격내성 * -1}
        ENDIF
    ELSEIF 속성 == "질풍"
        IF T_내질풍내성 > 0
            IF 데미지 >= T_내질풍내성
                데미지 -= T_내질풍내성
            ELSE
                데미지 = 0
            ENDIF
            PRINTFORM  -질풍내성{T_내질풍내성}
        ELSE
            데미지 += T_내질풍내성
            SIF T_내질풍내성 < 0
                PRINTFORM  +질풍취약{T_내질풍내성 * -1}
        ENDIF
    ELSEIF 속성 == "수격"
        IF T_내수격내성 > 0
            IF 데미지 >= T_내수격내성
                데미지 -= T_내수격내성
            ELSE
                데미지 = 0
            ENDIF
            PRINTFORM  -수격내성{T_내수격내성}
        ELSE
            데미지 += T_내수격내성
            SIF T_내수격내성 < 0
                PRINTFORM  +수격취약{T_내수격내성 * -1}
        ENDIF
    ELSEIF 속성 == "마력"
        IF T_내마력내성 > 0
            IF 데미지 >= T_내마력내성
                데미지 -= T_내마력내성
            ELSE
                데미지 = 0
            ENDIF
            PRINTFORM  -마력내성{T_내마력내성}
        ELSE
            데미지 += T_내마력내성
            SIF T_내마력내성 < 0
                PRINTFORM  +마력취약{T_내마력내성 * -1}
        ENDIF
    ELSEIF 속성 == "정신"
        IF T_내정신내성 > 0
            IF 데미지 >= T_내정신내성
                데미지 -= T_내정신내성
            ELSE
                데미지 = 0
            ENDIF
                PRINTFORM  -정신내성{T_내정신내성}
        ELSE
            데미지 += T_내정신내성
            SIF T_내정신내성 < 0
                PRINTFORM  +정신취약{T_내정신내성 * -1}
        ENDIF
    ELSEIF 속성 == "고정"
        ;처리없음
    ELSE
        ;특수피해 처리용(독이나 출혈같은거)
        T_내체력 -= 데미지
        PRINTL
        PRINTFORMW {데미지}만큼의 %속성% 피해를 받았다!
        RETURN 1
    ENDIF
    IF T_내방어력 >= 0
        데미지 -= T_내방어력
        SIF T_내방어력 > 0
            PRINTFORM  -방어력{T_내방어력}
    ELSE
        데미지 += T_내방어력
        SIF T_내방어력 < 0
            PRINTFORM  +방어불가{T_내방어력 * -1}
    ENDIF
    PRINTL
    CALL 크리티컬판정(T_적운)
    IF RESULT == 1
        PRINTFORML 급소에 맞았다!
        데미지 += T_적운
        TIMES 데미지 , 1.5
    ENDIF
    IF 데미지 > 0
        T_내체력 -= 데미지
        PRINTFORMW {데미지}만큼의 %속성% 피해를 받았다!
    ELSEIF 데미지 <= -100
        PRINTFORMW 가볍게 피했다
    ELSE
        PRINTFORMW 피했다!
    ENDIF
ELSEIF 대상 == TARGET
    IF 속성 == "물리"
        IF T_적물리내성 > 0
            IF 데미지 >= T_적물리내성
                데미지 -= T_적물리내성
            ELSE
                데미지 = 0
            ENDIF
            PRINTFORM  -물리내성{T_적물리내성}
        ELSE
            데미지 += T_적물리내성
            SIF T_적물리내성 < 0
                PRINTFORM  +물리취약{T_적물리내성 * -1}
        ENDIF
    ELSEIF 속성 == "화염"
        IF T_적화염내성 > 0
            IF 데미지 >= T_적화염내성
                데미지 -= T_적화염내성
            ELSE
                데미지 = 0
            ENDIF
            PRINTFORM  -화염내성{T_적화염내성}
        ELSE
            데미지 += T_적화염내성
            SIF T_적화염내성 < 0
                PRINTFORM  +화염취약{T_적화염내성 * -1}
        ENDIF
    ELSEIF 속성 == "빙결"
        IF T_적빙결내성 > 0
            IF 데미지 >= T_적빙결내성
                데미지 -= T_적빙결내성
            ELSE
                데미지 = 0
            ENDIF
            PRINTFORM  -빙결내성{T_적빙결내성}
        ELSE
            데미지 += T_적빙결내성
            SIF T_적빙결내성 < 0
                PRINTFORM  +빙결취약{T_적빙결내성 * -1}
        ENDIF
    ELSEIF 속성 == "전격"
        IF T_적전격내성 > 0
            IF 데미지 >= T_적전격내성
                데미지 -= T_적전격내성
            ELSE
                데미지 = 0
            ENDIF
            PRINTFORM  -전격내성{T_적전격내성}
        ELSE
            데미지 += T_적전격내성
            SIF T_적전격내성 < 0
                PRINTFORM  +전격취약{T_적전격내성 * -1}
        ENDIF
    ELSEIF 속성 == "질풍"
        IF T_적질풍내성 > 0
            IF 데미지 >= T_적질풍내성
                데미지 -= T_적질풍내성
            ELSE
                데미지 = 0
            ENDIF
            PRINTFORM  -질풍내성{T_적질풍내성}
        ELSE
            데미지 += T_적질풍내성
            SIF T_적질풍내성 < 0
                PRINTFORM  +질풍취약{T_적질풍내성 * -1}
        ENDIF
    ELSEIF 속성 == "수격"
        IF T_적수격내성 > 0
            IF 데미지 >= T_적수격내성
                데미지 -= T_적수격내성
            ELSE
                데미지 = 0
            ENDIF
            PRINTFORM  -수격내성{T_적수격내성}
        ELSE
            데미지 += T_적수격내성
            SIF T_적수격내성 < 0
                PRINTFORM  +수격취약{T_적수격내성 * -1}
        ENDIF
    ELSEIF 속성 == "마력"
        IF T_적마력내성 > 0
            IF 데미지 >= T_적마력내성
                데미지 -= T_적마력내성
            ELSE
                데미지 = 0
            ENDIF
            PRINTFORM  -마력내성{T_적마력내성}
        ELSE
            데미지 += T_적마력내성
            SIF T_적마력내성 < 0
                PRINTFORM  +마력취약{T_적마력내성 * -1}
        ENDIF
    ELSEIF 속성 == "정신"
        IF T_적정신내성 > 0
            IF 데미지 >= T_적정신내성
                데미지 -= T_적정신내성
            ELSE
                데미지 = 0
            ENDIF
                PRINTFORM  -정신내성{T_적정신내성}
        ELSE
            데미지 += T_적정신내성
            SIF T_적정신내성 < 0
                PRINTFORM  +정신취약{T_적정신내성 * -1}
        ENDIF
    ELSEIF 속성 == "고정"
        ;처리없음
    ELSE
        ;특수피해 처리용(독이나 출혈같은거)
        T_적체력 -= 데미지
        PRINTL
        PRINTFORMW %타겟은% {데미지}만큼의 %속성% 피해를 받았다!
        RETURN 1
    ENDIF
    IF T_적방어력 >= 0
        데미지 -= T_적방어력
        SIF T_적방어력 > 0
            PRINTFORM  -방어력{T_적방어력}
    ELSE
        데미지 += T_적방어력
        SIF T_적방어력 < 0
            PRINTFORM  +방어불가{T_적방어력 * -1}
    ENDIF
    PRINTL
    CALL 크리티컬판정(T_내운)
    IF RESULT == 1
        PRINTFORML 급소에 맞혔다!
        데미지 += T_내운
        TIMES 데미지 , 1.5
    ENDIF
    IF 데미지 > 0
        T_적체력 -= 데미지
        PRINTFORMW %T_적에게% {데미지}만큼의 %속성% 피해를 주었다!
    ELSEIF 데미지 <= -100
        PRINTFORMW %타겟은% 가볍게 피해버렸다...
    ELSE
        PRINTFORMW %타겟은% 아슬아슬하게 탄을 피했다!
    ENDIF
ENDIF


@크리티컬판정(ARG)
#DIM DYNAMIC 크리티컬
크리티컬 = MIN(ARG, 100)

IF 크리티컬 >= RAND:100 + 1
    ;명중
    RETURN 1
ELSE
    ;빗나감
    RETURN 0
ENDIF

@능력치세팅(ARG)
;190,요정
;191,봉래인
;192,비생물
;193,신령
;194,인간
;195,오니
;196,츠쿠모가미
;197,텐구
;
;일단 임시 세팅, 상세 수치는 나중에 자세히 쓴다
IF CFLAG:ARG:능력치세팅여부 == 0 && CFLAG:ARG:힘 == 0 && CFLAG:ARG:지성 == 0 &&CFLAG:ARG:속도 == 0&&CFLAG:ARG:인내 == 0&&CFLAG:ARG:운 == 0
    CFLAG:ARG:능력치세팅여부 == 1
    TRYCALLFORM 개별능력치세팅{ARG}
    IF RESULT == 1
        RETURN
    ENDIF
    IF TALENT:ARG:인간
        CFLAG:ARG:힘 = 15
        CFLAG:ARG:지성 = 15
        CFLAG:ARG:속도 = 15
        CFLAG:ARG:인내 = 15
        CFLAG:ARG:운 = 15
    ELSEIF TALENT:ARG:요정
        CFLAG:ARG:힘 = 10
        CFLAG:ARG:지성 = 10
        CFLAG:ARG:속도 = 10
        CFLAG:ARG:인내 = 10
        CFLAG:ARG:운 = 10
    ELSEIF TALENT:ARG:봉래인
        CFLAG:ARG:힘 = 15
        CFLAG:ARG:지성 = 15
        CFLAG:ARG:속도 = 15
        CFLAG:ARG:인내 = 25
        CFLAG:ARG:운 = 15
    ELSEIF TALENT:ARG:비생물
        CFLAG:ARG:힘 = 5
        CFLAG:ARG:지성 = 15
        CFLAG:ARG:속도 = 15
        CFLAG:ARG:인내 = 35
        CFLAG:ARG:운 = 15
    ELSEIF TALENT:ARG:신령
        CFLAG:ARG:힘 = 80
        CFLAG:ARG:지성 = 80
        CFLAG:ARG:속도 = 80
        CFLAG:ARG:인내 = 80
        CFLAG:ARG:운 = 80
    ELSEIF TALENT:ARG:오니
        CFLAG:ARG:힘 = 65
        CFLAG:ARG:지성 = 65
        CFLAG:ARG:속도 = 65
        CFLAG:ARG:인내 = 65
        CFLAG:ARG:운 = 65
    ELSEIF TALENT:ARG:츠쿠모가미
        CFLAG:ARG:힘 = 10
        CFLAG:ARG:지성 = 15
        CFLAG:ARG:속도 = 15
        CFLAG:ARG:인내 = 40
        CFLAG:ARG:운 = 15
    ELSEIF TALENT:ARG:텐구
        CFLAG:ARG:힘 = 45
        CFLAG:ARG:지성 = 45
        CFLAG:ARG:속도 = 50
        CFLAG:ARG:인내 = 45
        CFLAG:ARG:운 = 45
    ELSE
        CFLAG:ARG:힘 = 35
        CFLAG:ARG:지성 = 35
        CFLAG:ARG:속도 = 35
        CFLAG:ARG:인내 = 35
        CFLAG:ARG:운 = 35
    ENDIF
ENDIF

@상태이상부여(ARG, 상태이상, ARG:1, ARG:2)
#DIMS 상태이상
;ARG = 상대
;ARG:1 = 명중률
;ARG:2 = 지속시간
IF ARG:1 >= RAND:100 + 1
    IF ARG == MASTER
        IF 상태이상 == "기절"
            T_내기절 = ARG:2
        ELSEIF 상태이상 == "실명"
            T_내실명 = ARG:2
        ELSEIF 상태이상 == "침묵"
            T_내침묵 = ARG:2
        ELSEIF 상태이상 == "혼란"
            T_내혼란 = ARG:2
        ELSEIF 상태이상 == "취약"
            T_내취약 = ARG:2
        ELSEIF 상태이상 == "힘감소"
            T_내힘감소 = ARG:2
        ELSEIF 상태이상 == "지성감소"
            T_내지성감소 = ARG:2
        ELSEIF 상태이상 == "속도감소"
            T_내속도감소 = ARG:2
        ELSEIF 상태이상 == "인내감소"
            T_내인내감소 = ARG:2
        ELSEIF 상태이상 == "운감소"
            T_내운감소 = ARG:2
        ELSEIF 상태이상 == "독"
            T_내독 = ARG:2
        ELSEIF 상태이상 == "출혈"
            T_내출혈 = ARG:2
        ELSEIF 상태이상 == "저주"
            T_내저주 = ARG:2
        ENDIF
    ELSEIF ARG == TARGET
        IF 상태이상 == "기절"
            T_적기절 = ARG:2
        ELSEIF 상태이상 == "실명"
            T_적실명 = ARG:2
        ELSEIF 상태이상 == "침묵"
            T_적침묵 = ARG:2
        ELSEIF 상태이상 == "혼란"
            T_적혼란 = ARG:2
        ELSEIF 상태이상 == "취약"
            T_적취약 = ARG:2
        ELSEIF 상태이상 == "힘감소"
            T_적힘감소 = ARG:2
        ELSEIF 상태이상 == "지성감소"
            T_적지성감소 = ARG:2
        ELSEIF 상태이상 == "속도감소"
            T_적속도감소 = ARG:2
        ELSEIF 상태이상 == "인내감소"
            T_적인내감소 = ARG:2
        ELSEIF 상태이상 == "운감소"
            T_적운감소 = ARG:2
        ELSEIF 상태이상 == "독"
            T_적독 = ARG:2
        ELSEIF 상태이상 == "출혈"
            T_적출혈 = ARG:2
        ELSEIF 상태이상 == "저주"
            T_적저주 = ARG:2
        ENDIF
    ENDIF
ELSE
    RETURN 0
ENDIF

@능력치감소(ARG, 능력치, ARG:1, ARG:2, ARG:3)
#DIMS 능력치
;ARG = 상대
;ARG:1 = 감소량
;ARG:2 = 명중률
;ARG:3 = 지속시간
IF ARG:2 >= RAND:100 + 1
    IF ARG == MASTER
        IF 능력치 == "힘"
            SIF ARG:1 > T_내힘
                ARG:1 = T_내힘
            T_내힘감소 = ARG:3
            T_내힘 -= ARG:1
            T_내힘감소량 += ARG:1
        ELSEIF 능력치 == "지성"
            SIF ARG:1 > T_내지성
                ARG:1 = T_내지성
            T_내지성감소 = ARG:3
            T_내지성 -= ARG:1
            T_내지성감소량 += ARG:1
        ELSEIF 능력치 == "속도"
            SIF ARG:1 > T_내속도
                ARG:1 = T_내속도
            T_내속도감소 = ARG:3
            T_내속도 -= ARG:1
            T_내속도감소량 += ARG:1
        ELSEIF 능력치 == "인내"
            SIF ARG:1 > T_내인내
                ARG:1 = T_내인내
            T_내인내감소 = ARG:3
            T_내인내 -= ARG:1
            T_내인내감소량 += ARG:1
        ELSEIF 능력치 == "운"
            SIF ARG:1 > T_내운
                ARG:1 = T_내운
            T_내운감소 = ARG:3
            T_내운 -= ARG:1
            T_내운감소량 += ARG:1
        ELSE
            PRINTL 에러
            PRINTL 인수가 이상함
        ENDIF
    ELSEIF ARG == TARGET
        IF 능력치 == "힘"
            SIF ARG:1 > T_적힘
                ARG:1 = T_적힘
            T_적힘감소 = ARG:3
            T_적힘감소량 += ARG:1
        ELSEIF 능력치 == "지성"
            SIF ARG:1 > T_적지성
                ARG:1 = T_적지성
            T_적지성감소 = ARG:3
            T_적지성감소량 += ARG:1
        ELSEIF 능력치 == "속도"
            SIF ARG:1 > T_적속도
                ARG:1 = T_적속도
            T_적속도감소 = ARG:3
            T_적속도감소량 += ARG:1
        ELSEIF 능력치 == "인내"
             SIF ARG:1 > T_적인내
                ARG:1 = T_적인내
            T_적인내감소 = ARG:3
            T_적인내감소량 += ARG:1
        ELSEIF 능력치 == "운"
            SIF ARG:1 > T_적운
                ARG:1 = T_적운
            T_적운감소 = ARG:3
            T_적운감소량 += ARG:1
        ENDIF
    ENDIF
ELSE
    RETURN 0
ENDIF

@상태이상감소처리(ARG)
IF ARG == MASTER
    SIF T_내기절 > 0
        T_내기절--
    SIF T_내실명 > 0
        T_내실명--
    SIF T_내침묵 > 0
        T_내침묵--
    SIF T_내혼란 > 0
        T_내혼란--
    SIF T_내취약 > 0
        T_내취약--
    IF T_내힘감소 > 0
        T_내힘감소--
        IF T_내힘감소 == 0
            T_내힘 += T_내힘감소량
            T_내힘감소량 = 0
        ENDIF
    ENDIF
    IF T_내지성감소 > 0
        T_내지성감소--
        IF T_내지성감소 == 0
            T_내지성 += T_내지성감소량
            T_내지성감소량 = 0
        ENDIF
    ENDIF
    IF T_내속도감소 > 0
        T_내속도감소--
        IF T_내속도감소 == 0
            T_내속도 += T_내속도감소량
            T_내속도감소량 = 0
        ENDIF
    ENDIF
    IF T_내인내감소 > 0
        T_내인내감소--
        IF T_내인내감소 == 0
            T_내인내 += T_내인내감소량
            T_내인내감소량 = 0
        ENDIF
    ENDIF
    IF T_내운감소 > 0
        T_내운감소--
        IF T_내운감소 == 0
            T_내운 += T_내운감소량
            T_내운감소량 = 0
        ENDIF
    ENDIF
    IF T_내독 > 0
        T_내독--
        CALL T_데미지(MASTER,50,"독")
    ENDIF
    IF T_내출혈 > 0
        T_내출혈--
        CALL T_데미지(MASTER,(T_내최대체력/20),"출혈")
    ENDIF
    IF T_내저주 > 0
        T_내저주--
        IF T_내저주 == 0
            CALL T_데미지(MASTER,T_내최대체력,"저주")
        ENDIF
    ENDIF
ELSEIF ARG == TARGET
    SIF T_적기절 > 0
        T_적기절--
    SIF T_적실명 > 0
        T_적실명--
    SIF T_적침묵 > 0
        T_적침묵--
    SIF T_적혼란 > 0
        T_적혼란--
    SIF T_적취약 > 0
        T_적취약--
    
    IF T_적독 > 0
        T_적독--
        CALL T_데미지(TARGET,50,"독")
    ENDIF
    IF T_적출혈 > 0
        T_적출혈--
        CALL T_데미지(TARGET,(T_적최대체력/20),"출혈")
    ENDIF
    IF T_적저주 > 0
        T_적저주--
        IF T_적저주 == 0
            CALL T_데미지(TARGET,(T_적체력/2),"저주")
        ENDIF
    ENDIF
    IF T_적힘감소 > 0
        T_적힘감소--
        IF T_적힘감소 == 0
            T_적힘 += T_적힘감소량
            T_적힘감소량 = 0
        ENDIF
    ENDIF
    IF T_적지성감소 > 0
        T_적지성감소--
        IF T_적지성감소 == 0
            T_적지성 += T_적지성감소량
            T_적지성감소량 = 0
        ENDIF
    ENDIF
    IF T_적속도감소 > 0
        T_적속도감소--
        IF T_적속도감소 == 0
            T_적속도 += T_적속도감소량
            T_적속도감소량 = 0
        ENDIF
    ENDIF
    IF T_적인내감소 > 0
        T_적인내감소--
        IF T_적인내감소 == 0
            T_적인내 += T_적인내감소량
            T_적인내감소량 = 0
        ENDIF
    ENDIF
    IF T_적운감소 > 0
        T_적운감소--
        IF T_적운감소 == 0
            T_적운 += T_적운감소량
            T_적운감소량 = 0
        ENDIF
    ENDIF
ENDIF

@상태이상체크(ARG, ARGS)
#FUNCTION
;현재 걸린 상태이상의 지속시간을 반환, 0이 아닌경우 그 상태이상에 걸렸다고 판정할수 있다
IF ARG == MASTER
    IF ARGS == "기절"
        RETURNF T_내기절
    ELSEIF ARGS == "실명"
        RETURNF T_내실명
    ELSEIF ARGS == "침묵"
        RETURNF T_내침묵
    ELSEIF ARGS == "취약"
        RETURNF T_내취약
    ELSEIF ARGS == "혼란"
        RETURNF T_내혼란
    ELSEIF ARGS == "힘감소"
        RETURNF T_내힘감소
    ELSEIF ARGS == "지성감소"
        RETURNF T_내지성감소
    ELSEIF ARGS == "속도감소"
        RETURNF T_내속도감소
    ELSEIF ARGS == "인내감소"
        RETURNF T_내인내감소
    ELSEIF ARGS == "운감소"
        RETURNF T_내운감소
    ELSEIF ARGS == "독"
        RETURNF T_내독
    ELSEIF ARGS == "출혈"
        RETURNF T_내출혈
    ELSEIF ARGS == "저주"
        RETURNF T_내저주
    ENDIF
ELSEIF ARG == TARGET
    IF ARGS == "기절"
        RETURNF T_적기절
    ELSEIF ARGS == "실명"
        RETURNF T_적실명
    ELSEIF ARGS == "침묵"
        RETURNF T_적침묵
    ELSEIF ARGS == "취약"
        RETURNF T_적취약
    ELSEIF ARGS == "혼란"
        RETURNF T_적혼란
    ELSEIF ARGS == "힘감소"
        RETURNF T_적힘감소
    ELSEIF ARGS == "지성감소"
        RETURNF T_적지성감소
    ELSEIF ARGS == "속도감소"
        RETURNF T_적속도감소
    ELSEIF ARGS == "인내감소"
        RETURNF T_적인내감소
    ELSEIF ARGS == "운감소"
        RETURNF T_적운감소
    ELSEIF ARGS == "독"
        RETURNF T_적독
    ELSEIF ARGS == "출혈"
        RETURNF T_적출혈
    ELSEIF ARGS == "저주"
        RETURNF T_적저주
    ENDIF
ENDIF


@버프부여(ARG, 버프, ARG:1, ARG:2)
#DIMS 버프
;ARG = 대상
;ARG:1 = 증가량
;ARG:2 = 지속시간
IF ARG == MASTER
    IF 버프 == "회피"
        T_내회피 = ARG:2
        T_내회피량 += ARG:1
        T_내방어력보정 += T_내회피량
    ENDIF
ELSEIF ARG == TARGET
    IF 버프 == "회피"
        T_적회피 = ARG:2
        T_적회피량 += ARG:1
        T_적방어력보정 += T_적회피량
    ENDIF
ENDIF


@버프감소처리(ARG)
IF ARG == MASTER
    IF 버프체크(MASTER, "회피")
        T_내회피--
        IF T_내회피 == 0&&T_내회피량 > 0
            T_내방어력보정 -= T_내회피량
            T_내회피량 = 0
        ENDIF
    ENDIF
ELSEIF ARG == TARGET
    IF 버프체크(TARGET, "회피")
        T_적회피--
        IF T_적회피 == 0&&T_적회피량 > 0
            T_적방어력보정 -= T_적회피량
            T_적회피량 = 0
        ENDIF
    ENDIF
ENDIF


@버프체크(ARG,ARGS)
#FUNCTION
IF ARG == MASTER
    IF ARGS == "회피"
        RETURNF T_내회피
    ENDIF
ELSEIF ARG == TARGET
    IF ARGS == "회피"
        RETURNF T_적회피
    ENDIF
ENDIF